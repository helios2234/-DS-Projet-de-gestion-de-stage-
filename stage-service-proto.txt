syntax = "proto3";

package stageservice;

service StageService {
  rpc CreateStage(CreateStageRequest) returns (StageResponse);
  rpc UpdateStage(UpdateStageRequest) returns (StageResponse);
  rpc GetStage(GetStageRequest) returns (StageResponse);
  rpc ListStages(ListStagesRequest) returns (ListStagesResponse);
  rpc DeleteStage(DeleteStageRequest) returns (DeleteResponse);
  rpc AssignSupervisor(AssignSupervisorRequest) returns (StageResponse);
  rpc SubmitReport(SubmitReportRequest) returns (ReportResponse);
  rpc EvaluateStage(EvaluateStageRequest) returns (EvaluationResponse);
}

message CreateStageRequest {
  string student_id = 1;
  string student_name = 2;
  string student_email = 3;
  string student_phone = 4;
  string university_id = 5;
  string university_name = 6;
  string department = 7;
  string academic_level = 8;
  string company_id = 9;
  string company_name = 10;
  string company_address = 11;
  string company_city = 12;
  string company_region = 13;
  string stage_title = 14;
  string stage_description = 15;
  string start_date = 16;
  string end_date = 17;
  string stage_type = 18;
}

message StageResponse {
  bool success = 1;
  string message = 2;
  string stage_id = 3;
  StageMetadata metadata = 4;
}

message UpdateStageRequest {
  string stage_id = 1;
  string field_name = 2;
  string new_value = 3;
  string updated_by = 4;
}

message GetStageRequest {
  string stage_id = 1;
  string requester_id = 2;
}

message ListStagesRequest {
  string filter_type = 1;
  string filter_value = 2;
  string requester_role = 3;
  int32 page = 4;
  int32 page_size = 5;
}

message ListStagesResponse {
  repeated StageMetadata stages = 1;
  int32 total_count = 2;
  int32 page = 3;
  int32 total_pages = 4;
}

message StageMetadata {
  string stage_id = 1;
  string student_id = 2;
  string student_name = 3;
  string university_name = 4;
  string department = 5;
  string company_name = 6;
  string company_city = 7;
  string company_region = 8;
  string stage_title = 9;
  string start_date = 10;
  string end_date = 11;
  string status = 12;
  string academic_supervisor_id = 13;
  string company_supervisor_id = 14;
  string created_at = 15;
  string updated_at = 16;
  float progress_percentage = 17;
  int32 reports_submitted = 18;
}

message DeleteStageRequest {
  string stage_id = 1;
  string requester_id = 2;
  string reason = 3;
}

message DeleteResponse {
  bool success = 1;
  string message = 2;
}

message AssignSupervisorRequest {
  string stage_id = 1;
  string supervisor_id = 2;
  string supervisor_name = 3;
  string supervisor_email = 4;
  string supervisor_phone = 5;
  string supervisor_type = 6;
  string assigned_by = 7;
}

message SubmitReportRequest {
  string stage_id = 1;
  string report_id = 2;
  string report_type = 3;
  string report_title = 4;
  string report_content = 5;
  bytes report_file = 6;
  string submitted_by = 7;
  string submission_date = 8;
  int32 week_number = 9;
}

message ReportResponse {
  bool success = 1;
  string message = 2;
  string report_id = 3;
  ReportMetadata metadata = 4;
}

message ReportMetadata {
  string report_id = 1;
  string stage_id = 2;
  string report_type = 3;
  string report_title = 4;
  string submitted_by = 5;
  string submission_date = 6;
  string status = 7;
  string reviewed_by = 8;
  string review_date = 9;
  string feedback = 10;
  float score = 11;
}

message EvaluateStageRequest {
  string stage_id = 1;
  string evaluator_id = 2;
  string evaluator_type = 3;
  float technical_skills_score = 4;
  float soft_skills_score = 5;
  float attendance_score = 6;
  float initiative_score = 7;
  float report_quality_score = 8;
  string comments = 9;
  string recommendation = 10;
}

message EvaluationResponse {
  bool success = 1;
  string message = 2;
  string evaluation_id = 3;
  EvaluationMetadata metadata = 4;
}

message EvaluationMetadata {
  string evaluation_id = 1;
  string stage_id = 2;
  string evaluator_id = 3;
  string evaluator_type = 4;
  float final_score = 5;
  string grade = 6;
  string status = 7;
  string evaluation_date = 8;
  string comments = 9;
}
